cmake_minimum_required(VERSION 2.8 FATAL_ERROR)
set(CMAKE_LEGACY_CYGWIN_WIN32 0)
option(DMUX_USE_CLANG "use clang" ON)
if (DMUX_USE_CLANG)
    set(CMAKE_CXX_COMPILER clang++)
    set(CMAKE_C_COMPILER clang)
endif (DMUX_USE_CLANG)

project(dmux)

enable_testing()

find_package(Boost COMPONENTS system thread unit_test_framework REQUIRED)
if (Boost_FOUND)
    add_definitions(-DDMUX_BOOST_ENABLED)
    include_directories(${Boost_INCLUDE_DIRS})
endif (Boost_FOUND)

set(CMAKE_CXX_FLAGS "-Wall -Werror -g3")
option(CMAKE_EXPORT_COMPILE_COMMANDS ON)
add_subdirectory(dmux)
option(DMUX_EXAMPLES_ENABLED "the examples are enabled" ON)
if (DMUX_EXAMPLES_ENABLED)
    add_subdirectory(examples)
endif (DMUX_EXAMPLES_ENABLED)
option(DMUX_TEST_ENABLED "the tests are enabled" ON)
if (Boost_FOUND AND DMUX_TEST_ENABLED)
    add_subdirectory(tests)
endif (Boost_FOUND AND DMUX_TEST_ENABLED)
